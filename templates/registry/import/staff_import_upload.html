{% extends 'base.html' %}
{% load crispy_forms_tags %}

{% block title %}นำเข้าข้อมูลจาก Excel{% endblock %}

{% block content %}
<div class="container-fluid">
    <!-- Breadcrumb -->
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="{% url 'dashboard' %}">หน้าหลัก</a></li>
            <li class="breadcrumb-item"><a href="{% url 'registry:staff_list' %}">รายการบุคลากร</a></li>
            <li class="breadcrumb-item active" aria-current="page">นำเข้าจาก Excel</li>
        </ol>
    </nav>

    <!-- Header -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="mb-0">
            <i class="bi bi-file-earmark-excel text-success"></i>
            นำเข้าข้อมูลบุคลากรจาก Excel
        </h2>
    </div>

    <!-- Form Card -->
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="card shadow-sm">
                <div class="card-body p-4">
                    <h5 class="card-title mb-4">
                        <i class="bi bi-upload"></i> เลือกไฟล์และระบุข้อมูลเบื้องต้น
                    </h5>

                    {% crispy form %}
                </div>
            </div>

            <!-- Instructions Card -->
            <div class="card mt-4">
                <div class="card-header bg-light">
                    <h6 class="mb-0 text-dark"><i class="bi bi-info-circle"></i> รูปแบบไฟล์ Excel</h6>
                </div>
                <div class="card-body">
                    <p class="mb-2"><strong>โครงสร้างไฟล์:</strong></p>
                    <ul class="small">
                        <li>แถวที่ 1-4: หัวข้อ (ระบบจะข้ามไป)</li>
                        <li>แถวที่ 5 เป็นต้นไป: ข้อมูลบุคลากร</li>
                    </ul>

                    <p class="mb-2 mt-3"><strong>คอลัมน์ที่ต้องมี (A-P):</strong></p>
                    <div class="table-responsive">
                        <table class="table table-sm table-bordered">
                            <thead class="table-light">
                                <tr>
                                    <th>คอลัมน์</th>
                                    <th>ชื่อฟิลด์</th>
                                    <th>ตัวอย่าง</th>
                                </tr>
                            </thead>
                            <tbody class="small">
                                <tr><td>A</td><td>ลำดับ</td><td>1, 2, 3...</td></tr>
                                <tr><td>B</td><td>ยศ</td><td>นาย, นาง, พล.อ.</td></tr>
                                <tr><td>C</td><td>ชื่อ</td><td>สมชาย</td></tr>
                                <tr><td>D</td><td>นามสกุล</td><td>ใจดี</td></tr>
                                <tr><td>E</td><td>บัตรประชาชน</td><td>1234567890123</td></tr>
                                <tr><td>F</td><td>หน่วยงาน</td><td>ม.นครพนม</td></tr>
                                <tr><td>G</td><td>ประเภทบุคคล</td><td>บุคคลชั้นในสุด</td></tr>
                                <tr><td>H</td><td>หน้าที่</td><td>เจ้าหน้าที่</td></tr>
                                <tr><td>I</td><td>อายุ</td><td>35</td></tr>
                                <tr><td>J-M</td><td>วัคซีนเข็ม 1-4</td><td>1 (ถ้ารับ)</td></tr>
                                <tr><td>N</td><td>RT-PCR</td><td>1 (ถ้าตรวจ)</td></tr>
                                <tr><td>O</td><td>ATK</td><td>1 (ถ้าตรวจ)</td></tr>
                                <tr><td>P</td><td>วัดอุณหภูมิ</td><td>1 (ถ้าตรวจ)</td></tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="alert alert-warning mt-3 mb-0">
                        <i class="bi bi-exclamation-triangle"></i>
                        <strong>หมายเหตุ:</strong> รูปภาพไม่สามารถ import ได้ กรุณาเพิ่มรูปภาพภายหลังผ่านการแก้ไขข้อมูล
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
/* ทำให้เครื่องหมาย * (required) เป็นสีแดง */
.asteriskField {
    color: red;
    font-weight: bold;
}
</style>
{% endblock %}
